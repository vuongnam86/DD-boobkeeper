"use strict";const e=require("vue"),a=require("./classes-Jfk71KSq.js"),t=require("./useAlignment-RPvtO3-y.js"),l=require("./useId-owZCNodL.js"),i=require("./index-C8tYBJvG.js"),n=require("./keys-D59bcWpQ.js"),u=require("./useDefaults-DspAih6L.js"),d=require("./dom-Cbel14Rh.js"),s=require("./flattenFragments-Dj-WOIPD.js"),o=e.defineComponent({inheritAttrs:!1,__name:"BTab",props:e.mergeModels({buttonId:{default:void 0},disabled:{type:Boolean,default:!1},id:{default:void 0},lazy:{type:Boolean,default:void 0},unmountLazy:{type:Boolean,default:void 0},noBody:{type:Boolean,default:!1},tag:{default:"div"},title:{default:void 0},titleItemClass:{default:void 0},titleLinkAttrs:{default:void 0},titleLinkClass:{default:void 0}},{active:{type:Boolean,default:!1},activeModifiers:{}}),emits:["update:active"],setup(a,{expose:t}){const i=a,d=u.useDefaults(i,"BTab"),s=e.useSlots(),o=e.useAttrs(),v=e.useModel(a,"active"),r=e.inject(n.tabsInjectionKey,null),c=e.ref(d.id),f=l.useId("","tabpane"),p=e.computed(()=>d.id??c.value??f.value),m=l.useId(()=>d.buttonId,"tab"),b=e.ref(!1),y=e.useTemplateRef("_el"),C=e.computed(()=>{const{onClick:e,...a}=o;return a});r&&(!function(){if(!r)return;const a=r.registerTab(e.computed(()=>({internalId:f.value,id:p.value,active:v.value,buttonId:m.value,disabled:d.disabled,title:d.title,titleComponent:s.title,titleItemClass:d.titleItemClass,titleLinkAttrs:d.titleLinkAttrs,titleLinkClass:d.titleLinkClass,onClick:o.onClick,el:y})));a!==c.value&&(c.value=a)}(),v.value&&r.activateTab(f.value)),e.onUnmounted(()=>{r&&r.unregisterTab(f.value)});const I=e.computed(()=>r?.activeId.value===p.value),k=e.ref(I.value),h=e.computed(()=>!(!r?.lazy.value&&!d.lazy)),B=e.computed(()=>I.value&&!d.disabled),g=e.computed(()=>B.value||!h.value||h.value&&!d.unmountLazy&&b.value);e.watch(g,e=>{e&&!b.value&&(b.value=!0)}),e.watch(I,e=>{if(e)return v.value=!0,void setTimeout(()=>{k.value=!0},0);k.value=!1,v.value=!1}),e.watch(v,e=>{d.disabled?v.value=!1:r&&(e?I.value||r.activateTab(f.value):I.value&&r.activateTab(void 0))});const x=e.computed(()=>[{active:I.value,show:k.value,"card-body":r?.card.value&&!1===d.noBody,fade:!r?.noFade.value},k.value?r?.activeTabClass.value:r?.inactiveTabClass.value,r?.tabClass.value]);return t({activate:()=>{v.value=!0},deactivate:()=>{v.value=!1}}),(a,t)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(d).tag),e.mergeProps({id:p.value,ref:"_el",class:["tab-pane",x.value],role:"tabpanel","aria-labelledby":e.unref(m)},C.value),{default:e.withCtx(()=>[g.value?e.renderSlot(a.$slots,"default",{key:0}):e.createCommentVNode("",!0)]),_:3},16,["id","class","aria-labelledby"]))}}),v=["aria-orientation"],r=["id","aria-controls","aria-selected","disabled","tabindex","onClick"],c=e.defineComponent({__name:"BTabs",props:e.mergeModels({activeNavItemClass:{default:void 0},activeTabClass:{default:void 0},align:{default:void 0},card:{type:Boolean,default:!1},contentClass:{default:void 0},end:{type:Boolean,default:!1},fill:{type:Boolean,default:!1},id:{default:void 0},index:{},inactiveNavItemClass:{default:void 0},inactiveTabClass:{default:void 0},justified:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},navClass:{default:void 0},navItemClass:{default:void 0},navWrapperClass:{default:void 0},noFade:{type:Boolean,default:!1},noKeyNav:{type:Boolean,default:!1},noNavStyle:{type:Boolean,default:!1},pills:{type:Boolean,default:!1},small:{type:Boolean,default:!1},tag:{default:"div"},tabClass:{default:void 0},underline:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1}},{index:{default:-1},indexModifiers:{},modelValue:{default:void 0},modelModifiers:{}}),emits:e.mergeModels(["activate-tab"],["update:index","update:modelValue"]),setup(c,{emit:f}){const p=c,m=u.useDefaults(p,"BTabs"),b=f,y=e.useSlots(),C=e.useModel(c,"index"),I=e.useModel(c,"modelValue"),k=i.createReusableTemplate(),h=e.ref([]),B=e.ref([]),g=e.ref(!1),x=e.ref([]),w=()=>{const a=s.flattenFragments(y.default?.({})??[]);B.value=(Array.isArray(a)?a:[a]).filter(e=>e.type===o),0===x.value.length&&(x.value=B.value.map(a=>e.unref(l.useId(()=>a.props?.id,"tabpane")))),g.value=B.value.some(e=>void 0!==e.props?.active&&!1!==e.props?.active)};w(),e.watch(()=>y.default?.({}),()=>{w(),e.nextTick(()=>{D()})});const T=e.computed(()=>{if(0===h.value.length){const e=B.value.findIndex(e=>void 0!==e.props?.active&&(!1===e.props.disabled||void 0===e.props.disabled)||I.value&&e.props?.id===I.value);return B.value.map((a,t)=>{const l=-1!==e?t===e:C.value>-1?t===C.value:0===t;return{id:a.props?.id??x.value[t],internalId:`premount-${t}`,buttonId:a.props?.buttonId,disabled:a.props?.disabled,title:a.props?.title,titleComponent:a.children?.title,titleItemClass:a.props?.titleItemClass,titleLinkAttrs:a.props?.titleLinkAttrs,titleLinkClass:a.props?.titleLinkClass,onClick:a.props?.onClick,active:l,navItemClasses:[{active:l,disabled:!(!1===a.props?.disabled||void 0===a.props?.disabled)},l?m.activeNavItemClass:m.inactiveNavItemClass,m.navItemClass]}})}return h.value.map(a=>{const t=e.unref(a),l=t.id===I.value;return{...t,active:l,navItemClasses:[{active:l,disabled:t.disabled},l?m.activeNavItemClass:m.inactiveNavItemClass,m.navItemClass]}})});let N=!1,M=!1,K=!1;function z(){if(M){const a=T.value.findIndex(e=>e.id===I.value);-1!==a&&e.nextTick(()=>{C.value=a,M=!1})}K&&C.value>-1&&T.value[C.value]?.id&&e.nextTick(()=>{I.value=T.value[C.value]?.id,K=!1})}-1===C.value&&I.value?-1!==T.value.findIndex(e=>e.id===I.value)?C.value=T.value.findIndex(e=>e.id===I.value):M=!0:C.value>-1&&!I.value?T.value[C.value]?.id?I.value=T.value[C.value]?.id:K=!0:-1!==C.value||I.value||g.value?-1===C.value&&!I.value&&g.value&&(C.value=T.value.findIndex(e=>void 0!==e.active&&!1!==e.active&&(void 0===e.disabled||!1===e.disabled)),I.value=T.value[C.value]?.id):(C.value=T.value.findIndex(e=>void 0===e.disabled||!1===e.disabled),I.value=T.value[C.value]?.id),z();const L=e.computed(()=>!(T?.value&&T.value.length>0)),j=e.computed(()=>({"d-flex":m.vertical,"align-items-start":m.vertical})),_=t.useAlignment(()=>m.align),E=e.computed(()=>({"nav-pills":m.pills,"nav-underline":m.underline,"flex-column me-3":m.vertical,[_.value]:void 0!==m.align,"nav-fill":m.fill,"card-header-tabs":m.card&&!m.pills&&!m.underline,"card-header-pills":m.card&&m.pills,"nav-justified":m.justified,"nav-tabs":!m.noNavStyle&&!m.pills&&!m.underline,small:m.small})),V=(a,t)=>{T.value.length<=0||m.noKeyNav||(a.preventDefault(),a.stopPropagation(),C.value=A(C.value+t,t),e.nextTick(()=>{C.value>=0&&document.getElementById(T.value[C.value]?.buttonId)?.focus()}))},A=(e,a)=>{let t=e,l=-1,i=-1;for(let n=0;n<T.value.length;n++)T.value[n].disabled||(-1===l&&(l=n),i=n);for(;t>=l&&t<=i&&T.value[t].disabled;)t+=a;return t<l&&(t=l),t>i&&(t=i),t};let S,q=!1;e.watch(C,(t,l)=>{if(T.value.length<=0||T.value.filter(e=>!e.disabled).length<=0)return;if(q)return void(q=!1);const i=A(t,t>l?1:-1);if(i!==t)return S=l,void(C.value=i);const n=new a.BvEvent("activate-tab",{cancelable:!0});if(b("activate-tab",T.value[i]?.id,T.value[S??l]?.id,i,S??l,n),n.defaultPrevented){q=!0;const a=S??l??A(0,1);return S=void 0,I.value!==T.value[a]?.id&&(I.value=T.value[a]?.id),void e.nextTick(()=>{a>=0&&document.getElementById(T.value[a]?.buttonId)?.focus()})}I.value!==T.value[i]?.id&&(I.value=T.value[i]?.id),S=void 0}),e.watch(I,(a,t)=>{if(T.value.length<=0||T.value.filter(e=>!e.disabled).length<=0)return;const l=T.value.findIndex(e=>e.id===a);if(l===C.value)return;const i=T.value.findIndex(e=>e.id===t);if(!T.value[l]?.disabled)return-1===l?(C.value=A(0,1),void e.nextTick(()=>{I.value=T.value[C.value]?.id})):void(C.value=l);C.value=A(l,l>i?1:-1)});e.onMounted(()=>{z(),D(),N=!0});const D=()=>{h.value.sort((e,a)=>d.sortSlotElementsByPosition(e.value.el.value,a.value.el.value)),I.value&&C.value!==T.value.findIndex(e=>e.id===I.value)&&(C.value=T.value.findIndex(e=>e.id===I.value))};return e.provide(n.tabsInjectionKey,{lazy:e.toRef(()=>m.lazy),card:e.toRef(()=>m.card),noFade:e.toRef(()=>m.noFade),activeTabClass:e.toRef(()=>m.activeTabClass),inactiveTabClass:e.toRef(()=>m.inactiveTabClass),tabClass:e.toRef(()=>m.tabClass),registerTab:a=>{const t=h.value.findIndex(e=>e.value.internalId===a.value.internalId);-1===t?(h.value.push(a),N&&e.nextTick(()=>{D()})):(h.value[t]=a,N&&D());const l=h.value.findIndex(e=>e.value.internalId===a.value.internalId);return a.value.id??(N?a.value.internalId:x.value[l])},unregisterTab:e=>{h.value=h.value.filter(a=>a.value.internalId!==e)},activeId:I,activateTab:e=>{const a=T.value.findIndex(a=>a.internalId===e);C.value=void 0!==e&&-1!==a?a:A(0,1)}}),(a,t)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(m).tag),{id:e.unref(m).id,class:e.normalizeClass(["tabs",j.value])},{default:e.withCtx(()=>[e.createVNode(e.unref(k).define,null,{default:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(["tab-content",e.unref(m).contentClass])},[e.renderSlot(a.$slots,"default"),L.value?(e.openBlock(),e.createElementBlock("div",{key:"bv-empty-tab",class:e.normalizeClass(["tab-pane active",{"card-body":e.unref(m).card}])},[e.renderSlot(a.$slots,"empty")],2)):e.createCommentVNode("",!0)],2)]),_:3}),e.unref(m).end?(e.openBlock(),e.createBlock(e.unref(k).reuse,{key:0})):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass([e.unref(m).navWrapperClass,{"card-header":e.unref(m).card,"ms-auto":a.vertical&&e.unref(m).end}])},[e.createElementVNode("ul",{class:e.normalizeClass(["nav",[E.value,e.unref(m).navClass]]),role:"tablist","aria-orientation":e.unref(m).vertical?"vertical":"horizontal"},[e.renderSlot(a.$slots,"tabs-start"),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(T.value,(a,l)=>(e.openBlock(),e.createElementBlock("li",{key:a.id??a.internalId,class:e.normalizeClass(["nav-item",a.titleItemClass]),role:"presentation"},[e.createElementVNode("button",e.mergeProps({id:a.buttonId,class:["nav-link",[a.navItemClasses,a.titleLinkClass]],role:"tab","aria-controls":a.id,"aria-selected":a.active,disabled:a.disabled,tabindex:e.unref(m).noKeyNav||a.active?void 0:-1,type:"button"},{ref_for:!0},a.titleLinkAttrs,{onKeydown:[t[0]||(t[0]=e.withKeys(e.withModifiers(a=>!e.unref(m).vertical&&V(a,-1),["exact"]),["left"])),t[1]||(t[1]=e.withKeys(e.withModifiers(a=>!e.unref(m).vertical&&V(a,-999),["shift"]),["left"])),t[2]||(t[2]=e.withKeys(e.withModifiers(a=>e.unref(m).vertical&&V(a,-1),["exact"]),["up"])),t[3]||(t[3]=e.withKeys(e.withModifiers(a=>e.unref(m).vertical&&V(a,-999),["shift"]),["up"])),t[4]||(t[4]=e.withKeys(e.withModifiers(a=>!e.unref(m).vertical&&V(a,1),["exact"]),["right"])),t[5]||(t[5]=e.withKeys(e.withModifiers(a=>!e.unref(m).vertical&&V(a,999),["shift"]),["right"])),t[6]||(t[6]=e.withKeys(e.withModifiers(a=>e.unref(m).vertical&&V(a,1),["exact"]),["down"])),t[7]||(t[7]=e.withKeys(e.withModifiers(a=>e.unref(m).vertical&&V(a,999),["shift"]),["down"])),t[8]||(t[8]=e.withKeys(e=>V(e,-999),["page-up"])),t[9]||(t[9]=e.withKeys(e=>V(e,999),["page-down"])),t[10]||(t[10]=e.withKeys(e=>V(e,-999),["home"])),t[11]||(t[11]=e.withKeys(e=>V(e,999),["end"]))],onClick:e.withModifiers(e=>{return a=e,void((t=l)>=0&&!T.value[t].disabled&&T.value[t]?.onClick&&"function"==typeof T.value[t].onClick&&(T.value[t].onClick?.(a),a.defaultPrevented)?document.getElementById(T.value[t].buttonId)?.blur():C.value=t);var a,t},["stop"])}),[a.titleComponent?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a.titleComponent),{key:0})):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(a.title),1)],64))],16,r)],2))),128)),e.renderSlot(a.$slots,"tabs-end")],10,v)],2),e.unref(m).end?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(e.unref(k).reuse,{key:1}))]),_:3},8,["id","class"]))}});exports._sfc_main=o,exports._sfc_main$1=c;
//# sourceMappingURL=BTabs.vue_vue_type_script_setup_true_lang-CLhgyJHj.js.map
