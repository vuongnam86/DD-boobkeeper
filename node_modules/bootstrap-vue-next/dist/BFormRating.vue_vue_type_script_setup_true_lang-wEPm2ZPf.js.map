{"version":3,"file":"BFormRating.vue_vue_type_script_setup_true_lang-wEPm2ZPf.js","sources":["../src/components/BFormRating/BFormRating.vue"],"sourcesContent":["<template>\n  <div\n    :id=\"computedId\"\n    :class=\"computedClasses\"\n    role=\"slider\"\n    :aria-valuemin=\"0\"\n    :aria-valuemax=\"clampedStars\"\n    :aria-valuenow=\"displayValue\"\n    :aria-valuetext=\"`${displayValue} of ${clampedStars}`\"\n    tabindex=\"0\"\n    @keydown=\"onKeydown\"\n  >\n    <input\n      v-if=\"props.name && !props.disabled\"\n      key=\"hidden\"\n      type=\"hidden\"\n      :name=\"props.name\"\n      :form=\"props.form\"\n      :value=\"localValue\"\n    />\n    <span\n      v-if=\"props.showClear && !props.readonly && !props.disabled\"\n      class=\"clear-button-spacing\"\n      @click=\"clearRating\"\n    >\n      <slot name=\"icon-clear\">\n        <svg\n          viewBox=\"0 0 16 16\"\n          role=\"img\"\n          aria-label=\"x\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          class=\"clear-icon\"\n        >\n          <g>\n            <path\n              d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708\"\n            />\n          </g>\n        </svg>\n      </slot>\n    </span>\n    <span\n      v-for=\"(starIndex, index) in clampedStars\"\n      :key=\"starIndex\"\n      class=\"star\"\n      @click=\"selectRating(starIndex)\"\n    >\n      <slot :star-index=\"starIndex\" :is-filled=\"isIconFull(index)\" :is-half=\"isIconHalf(index)\">\n        <span class=\"b-form-rating-star\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            :width=\"computedSize\"\n            :height=\"computedSize\"\n            fill=\"currentColor\"\n            :class=\"[iconColors[index].class]\"\n            :style=\"iconColors[index].style\"\n            class=\"star-spacing\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              v-if=\"isIconFull(index)\"\n              d=\"M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z\"\n            />\n            <path\n              v-else-if=\"isIconHalf(index)\"\n              d=\"M5.354 5.119 7.538.792A.52.52 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.54.54 0 0 1 16 6.32a.55.55 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.5.5 0 0 1-.146.05c-.342.06-.668-.254-.6-.642l.83-4.73L.173 6.765a.55.55 0 0 1-.172-.403.6.6 0 0 1 .085-.302.51.51 0 0 1 .37-.245zM8 12.027a.5.5 0 0 1 .232.056l3.686 1.894-.694-3.957a.56.56 0 0 1 .162-.505l2.907-2.77-4.052-.576a.53.53 0 0 1-.393-.288L8.001 2.223 8 2.226z\"\n            />\n            <path\n              v-else\n              d=\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.522 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z\"\n            />\n          </svg>\n        </span>\n      </slot>\n    </span>\n\n    <span\n      v-if=\"props.showValue || props.showValueMax\"\n      :style=\"{fontSize: computedSize}\"\n      class=\"rating-value-text\"\n    >\n      {{ displayValueText }}\n    </span>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, ref} from 'vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BFormRatingProps} from '../../types/ComponentProps'\nimport {useId} from '../../composables/useId'\nimport type {BFormRatingSlots} from '../../types'\n\nconst _props = withDefaults(defineProps<Omit<BFormRatingProps, 'modelValue'>>(), {\n  color: '',\n  id: undefined,\n  inline: false,\n  noBorder: false,\n  precision: 0,\n  readonly: false,\n  disabled: false,\n  form: undefined,\n  name: undefined,\n  showClear: false,\n  showValue: false,\n  showValueMax: false,\n  size: '1rem',\n  stars: 5,\n  variant: undefined,\n})\nconst props = useDefaults(_props, 'BFormRating')\ndefineSlots<BFormRatingSlots>()\n\nconst modelValue = defineModel<Exclude<BFormRatingProps['modelValue'], undefined>>({default: 0})\n\nconst computedId = useId(() => props.id, 'form-rating')\n\nconst computedClasses = computed(() => ({\n  'is-readonly': props.readonly,\n  'is-disabled': props.disabled,\n  'no-border': props.noBorder,\n  'b-form-rating': true,\n  'd-inline-block': props.inline,\n  'w-100': !props.inline,\n}))\n\nfunction isIconFull(index: number): boolean {\n  return displayValue.value - index >= 1\n}\n\nfunction isIconHalf(index: number): boolean {\n  const diff = displayValue.value - index\n  return diff >= 0.5 && diff < 1\n}\n\nconst hoverValue = ref<number | null>(null)\n\nconst localValue = computed({\n  get: () => modelValue.value,\n  set: (value: number) => {\n    modelValue.value = value\n  },\n})\n\nconst displayValue = computed(() =>\n  hoverValue.value !== null ? hoverValue.value : localValue.value\n)\n\n// Set the minimum amount of star can be render to 3\nconst clampedStars = computed(() => Math.max(3, props.stars))\n\nconst computedSize = computed(() => {\n  if (props.size === 'sm') return '.875rem'\n  if (props.size === 'lg') return '1.25rem'\n  return props.size\n})\n\nconst displayValueText = computed(() => {\n  const decimalValue = props.precision > 0 ? roundedValue.value : displayValue.value\n  if (props.showValueMax) {\n    return `${decimalValue}/${clampedStars.value}`\n  }\n  if (props.showValue) {\n    return `${decimalValue}`\n  }\n  return ''\n})\n\nconst roundedValue = computed(() => {\n  const val = displayValue.value\n  const factor = 10 ** props.precision\n  return Math.round((val + Number.EPSILON) * factor) / factor\n})\n\nconst iconColors = computed(() =>\n  Array.from({length: clampedStars.value}, () => {\n    if (props.disabled) {\n      return {class: 'is-disabled', style: {}}\n    }\n    if (props.variant) {\n      return {class: `text-${props.variant}`, style: {}}\n    }\n    if (props.color) {\n      return {class: '', style: {color: props.color}}\n    }\n    return {class: '', style: {}}\n  })\n)\n\n//add keyboard support\nfunction onKeydown(e: KeyboardEvent) {\n  if (props.readonly || props.disabled) return\n\n  let newValue = localValue.value\n\n  switch (e.key) {\n    case 'ArrowRight':\n    case 'ArrowUp':\n      newValue = Math.min(newValue + 1, clampedStars.value)\n      break\n    case 'ArrowLeft':\n    case 'ArrowDown':\n      newValue = Math.max(newValue - 1, 0)\n      break\n    default:\n      return\n  }\n\n  e.preventDefault()\n  localValue.value = newValue\n}\n\nfunction selectRating(starIndex: number) {\n  if (props.readonly || props.disabled) return\n  const selectedRating = hoverValue.value !== null ? hoverValue.value : starIndex\n  localValue.value = selectedRating\n}\n\n// clear\nfunction clearRating() {\n  hoverValue.value = null\n  localValue.value = 0\n}\n\ndefineExpose({\n  hoverValue,\n})\n</script>\n"],"names":["_props","__props","props","useDefaults","modelValue","_useModel","computedId","useId","id","computedClasses","computed","readonly","disabled","noBorder","inline","isIconFull","index","displayValue","value","isIconHalf","diff","hoverValue","ref","localValue","get","set","clampedStars","Math","max","stars","computedSize","size","displayValueText","decimalValue","precision","roundedValue","showValueMax","showValue","val","factor","round","Number","EPSILON","iconColors","Array","from","length","class","style","variant","color","onKeydown","e","newValue","key","min","preventDefault","clearRating","__expose","_createElementBlock","_unref","role","tabindex","name","type","form","showClear","onClick","_renderSlot","_ctx","_createElementVNode","viewBox","xmlns","d","_openBlock","_Fragment","_renderList","starIndex","$event","selectedRating","selectRating","$slots","isFilled","isHalf","_hoisted_4","width","height","fill","_normalizeStyle","_hoisted_6","_hoisted_7","_hoisted_8"],"mappings":"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"}