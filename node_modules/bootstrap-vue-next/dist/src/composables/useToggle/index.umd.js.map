{"version":3,"file":"index.umd.js","sources":["../../../../src/composables/useToggle/index.ts"],"sourcesContent":["import {\n  type ComponentInternalInstance,\n  computed,\n  getCurrentInstance,\n  inject,\n  type MaybeRefOrGetter,\n  toValue,\n} from 'vue'\n\nimport {showHideRegistryKey} from '../../utils/keys'\nimport {getActiveShowHide} from '../../utils/registryAccess'\n\nexport const useToggle = (id: MaybeRefOrGetter<string | undefined> = undefined) => {\n  const instance = getCurrentInstance()\n  const storage = inject(showHideRegistryKey, null)\n\n  if (!storage) {\n    throw new Error(\n      'useToggle() must be called within setup(), and BApp, useRegistry or plugin must be installed/provided.'\n    )\n  }\n  const registry = storage.values\n  // const registry = toRef(() => appRegistry.value)\n  const findComponent = (\n    component: ComponentInternalInstance\n  ): ComponentInternalInstance | null => {\n    if (!component.parent) {\n      return null\n    }\n\n    if (\n      component.parent.exposed?.['id'] &&\n      registry.value.get(toValue(component.parent.exposed.id))\n    ) {\n      return component.parent\n    }\n\n    return findComponent(component.parent)\n  }\n\n  const myComponent = computed(() => {\n    const resolvedId = toValue(id)\n\n    if (resolvedId) {\n      return getActiveShowHide(registry, resolvedId)\n    }\n\n    if (!instance) {\n      return null\n    }\n\n    const component = findComponent(instance)\n    const componentId = toValue(component?.exposed?.id)\n    return getActiveShowHide(registry, componentId)\n  })\n\n  return {\n    value: computed(() => myComponent.value?.value),\n    show: (resolveOnHide?: boolean) =>\n      myComponent.value?.show(resolveOnHide) || Promise.reject('not found'),\n    hide: (trigger?: string) =>\n      myComponent.value?.hide(trigger, true) || Promise.reject('not found'),\n    toggle: (resolveOnHide?: boolean) =>\n      myComponent.value?.toggle(resolveOnHide) || Promise.reject('not found'),\n    component: computed(() => myComponent.value?.component),\n  }\n}\n"],"names":["id","instance","getCurrentInstance","storage","inject","showHideRegistryKey","Error","registry","values","findComponent","component","parent","exposed","value","get","toValue","myComponent","computed","resolvedId","getActiveShowHide","componentId","show","resolveOnHide","Promise","reject","hide","trigger","toggle"],"mappings":"iNAYyB,CAACA,OAA2C,KACnE,MAAMC,EAAWC,EAAAA,qBACXC,EAAUC,EAAAA,OAAOC,EAAAA,oBAAqB,MAE5C,IAAKF,EACH,MAAM,IAAIG,MACR,0GAGJ,MAAMC,EAAWJ,EAAQK,OAEnBC,EACJC,GAEKA,EAAUC,OAKbD,EAAUC,OAAOC,SAAc,IAC/BL,EAASM,MAAMC,IAAIC,EAAAA,QAAQL,EAAUC,OAAOC,QAAQZ,KAE7CU,EAAUC,OAGZF,EAAcC,EAAUC,QAVtB,KAaLK,EAAcC,EAAAA,SAAS,KAC3B,MAAMC,EAAaH,EAAAA,QAAQf,GAE3B,GAAIkB,EACF,OAAOC,EAAAA,kBAAkBZ,EAAUW,GAGrC,IAAKjB,EACH,OAAO,KAGT,MAAMS,EAAYD,EAAcR,GAC1BmB,EAAcL,EAAAA,QAAQL,GAAWE,SAASZ,IAChD,OAAOmB,EAAAA,kBAAkBZ,EAAUa,KAGrC,MAAO,CACLP,MAAOI,EAAAA,SAAS,IAAMD,EAAYH,OAAOA,OACzCQ,KAAOC,GACLN,EAAYH,OAAOQ,KAAKC,IAAkBC,QAAQC,OAAO,aAC3DC,KAAOC,GACLV,EAAYH,OAAOY,KAAKC,GAAS,IAASH,QAAQC,OAAO,aAC3DG,OAASL,GACPN,EAAYH,OAAOc,OAAOL,IAAkBC,QAAQC,OAAO,aAC7Dd,UAAWO,EAAAA,SAAS,IAAMD,EAAYH,OAAOH"}