{"version":3,"file":"index.umd.js","sources":["../../../../src/directives/BScrollspy/index.ts"],"sourcesContent":["import {type Directive, type DirectiveBinding} from 'vue'\nimport {useScrollspy} from '../../composables/useScrollspy'\nimport {omit} from '../../utils/object'\nimport {getDirectiveUid} from '../utils'\n\nexport interface ElementWithScrollspy extends HTMLElement {\n  $__scrollspy?: Record<number, ReturnType<typeof useScrollspy>>\n}\n\nconst bind = (el: ElementWithScrollspy, binding: Readonly<DirectiveBinding>) => {\n  // SSR guard: skip on server\n  if (typeof document === 'undefined') return\n\n  const uid = getDirectiveUid(binding)\n\n  // Initialize UID namespace for this directive\n  const elWithScrollspy = el as ElementWithScrollspy & Record<string, unknown>\n  elWithScrollspy.$__scrollspy = elWithScrollspy.$__scrollspy ?? Object.create(null)\n\n  // Clean up existing instance if present\n  const existingInstance = elWithScrollspy.$__scrollspy![uid]\n  if (existingInstance) {\n    existingInstance.cleanup()\n  }\n\n  const {arg, value} = binding\n  const isObject = typeof value === 'object' && value !== null\n  const content = arg\n    ? arg\n    : typeof value === 'string'\n      ? value\n      : isObject\n        ? value.content || value.element\n        : null\n\n  // Store scrollspy instance for this component instance\n  elWithScrollspy.$__scrollspy![uid] = useScrollspy(\n    content,\n    el,\n    isObject ? omit(value, ['content', 'element']) : {}\n  )\n}\n\nexport const vBScrollspy: Directive<ElementWithScrollspy> = {\n  mounted: bind,\n  updated: bind,\n  beforeUnmount(el, binding) {\n    const uid = getDirectiveUid(binding)\n    const elWithScrollspy = el as ElementWithScrollspy & Record<string, unknown>\n    const instance = elWithScrollspy.$__scrollspy?.[uid]\n\n    if (!instance) return\n\n    instance.cleanup()\n    delete elWithScrollspy.$__scrollspy![uid]\n  },\n}\n"],"names":["bind","el","binding","document","uid","getDirectiveUid","elWithScrollspy","$__scrollspy","Object","create","existingInstance","cleanup","arg","value","isObject","content","element","useScrollspy","omit","vBScrollspy","mounted","updated","beforeUnmount","instance"],"mappings":"+OASMA,EAAO,CAACC,EAA0BC,KAEtC,GAAwB,oBAAbC,SAA0B,OAErC,MAAMC,EAAMC,EAAAA,gBAAgBH,GAGtBI,EAAkBL,EACxBK,EAAgBC,aAAeD,EAAgBC,cAAgBC,OAAOC,OAAO,MAG7E,MAAMC,EAAmBJ,EAAgBC,aAAcH,GACnDM,GACFA,EAAiBC,UAGnB,MAAMC,IAACA,EAAAC,MAAKA,GAASX,EACfY,EAA4B,iBAAVD,GAAgC,OAAVA,EACxCE,EAAUH,IAEK,iBAAVC,EACLA,EACAC,EACED,EAAME,SAAWF,EAAMG,QACvB,MAGRV,EAAgBC,aAAcH,GAAOa,EAAAA,aACnCF,EACAd,EACAa,EAAWI,EAAAA,KAAKL,EAAO,CAAC,UAAW,YAAc,CAAA,IAIxCM,EAA+C,CAC1DC,QAASpB,EACTqB,QAASrB,EACT,aAAAsB,CAAcrB,EAAIC,GAChB,MAAME,EAAMC,EAAAA,gBAAgBH,GACtBI,EAAkBL,EAClBsB,EAAWjB,EAAgBC,eAAeH,GAE3CmB,IAELA,EAASZ,iBACFL,EAAgBC,aAAcH,GACvC"}